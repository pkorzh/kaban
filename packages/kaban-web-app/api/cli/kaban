#!/usr/bin/env node

require('../dal/connect')
const { tickets: ticketsDal } = require('../dal')

const shortid = require('shortid')

random_verb_parts = [
	'interrupt',
	'tour',
	'rejoice',
	'tempt',
	'smoke',
	'smash',
	'match',
	'flood',
	'fix',
	'untidy',
	'develop',
	'hum'
]

random_role_parts = ['User', 'Admin', 'Developer', 'Manager']

random_status_parts = ['backlog', 'ready-to-start', 'development', 'code-review', 'ready-to-verification', 'verification']

random_priority_parts = ['high', 'low', 'trivial']

random_type_parts = ['story', 'bug']

random_unicorn_parts = [
	'Quince Bonny Hooves',
	'Windy Velvet Horse',
	'Acorn Candy Nostrils',
	'Elm Dainty Ears',
	'Dandelion Dainty Lord',
	'Chestnut Pied Nose',
]

const skeleton = {
	name: 'Test',
	description: 'pofk',
	priority: { key: 'high' },
	type: { key: 'story' },
	resolution: null,
	assignee: { key: 'platon.korzh' },
	reporter: { key: 'platon.korzh' },
	backlog: { key: 'AMA'},
	status: { key: 'backlog' },
	lastTransitionAt: new Date(),
}

async function main() {
	for (var i = 100; i >= 0; i--) {
		const role = random_role_parts[Math.floor(Math.random()*random_role_parts.length)]
		const verb = random_verb_parts[Math.floor(Math.random()*random_verb_parts.length)]
		const unicorn = random_unicorn_parts[Math.floor(Math.random()*random_unicorn_parts.length)]

		const ticketSlim = {
			...skeleton,
			key: shortid.generate(),
			name: `As a ${role} i want to ${verb} ${unicorn}`,
			type: {
				key: random_type_parts[Math.floor(Math.random()*random_type_parts.length)]
			},
			priority: {
				key: random_priority_parts[Math.floor(Math.random()*random_priority_parts.length)]
			},
			//status: {
			//	key: random_status_parts[Math.floor(Math.random()*random_status_parts.length)]
			//}
		}

		console.log(ticketSlim.name)

		await ticketsDal.insert(ticketSlim)
	}

	console.log('Done.')
}

main()
